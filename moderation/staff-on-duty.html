<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Staff On Duty | YAGPDB Custom Commands</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://yagpdb-cc.github.io/moderation/staff-on-duty"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Staff On Duty | YAGPDB Custom Commands"><meta data-react-helmet="true" name="description" content="On-duty staffing system. You will need to set up an &quot;on duty&quot; role pingable by members."><meta data-react-helmet="true" property="og:description" content="On-duty staffing system. You will need to set up an &quot;on duty&quot; role pingable by members."><link data-react-helmet="true" rel="shortcut icon" href="/img/yag.ico"><link data-react-helmet="true" rel="canonical" href="https://yagpdb-cc.github.io/moderation/staff-on-duty"><link data-react-helmet="true" rel="alternate" href="https://yagpdb-cc.github.io/moderation/staff-on-duty" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://yagpdb-cc.github.io/moderation/staff-on-duty" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.10a8df27.css">
<link rel="preload" href="/assets/js/runtime~main.faac80f8.js" as="script">
<link rel="preload" href="/assets/js/main.0bbf4581.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?e("light"):e("dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/yag.ico" alt="YAGPDB logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/yag.ico" alt="YAGPDB logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">YAGPDB Custom Commands</b></a><a class="navbar__item navbar__link navbar__link--active" href="/">Introduction</a><a class="navbar__item navbar__link navbar__link--active" href="/adding-ccs">Adding custom commands</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/yagpdb-cc/yagpdb-cc/tree/master" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåô</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">‚òÄÔ∏è</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/adding-ccs">Adding Custom Commands</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">AFK System</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Birthday System</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Code Snippets</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Fun Commands</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Giveaway System</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Informational Commands</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Leveling System</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Moderation Commands</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/moderation/overview">Overview</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Raid Guard</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Custom Report System</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/moderation/emote-filter">Emote Filter</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/moderation/lockdown">Lockdown</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/moderation/nickname-moderation">Nickname Moderation</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/moderation/slowmode">Slowmode</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/moderation/staff-on-duty">Staff On Duty</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Suggestion System</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tag System</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Utility Commands</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Staff On Duty</h1></header><p>On-duty staffing system. You will need to set up an &quot;on duty&quot; role pingable by members.</p><p>The idea behind this CC is to have an easy way for server members to ping only the staff who have self designated themselves as available to moderate. In most servers pinging staff is discouraged to the point that people won&#x27;t do it even when swift moderation is necessary. By providing an encouraged method of reaching only the active staff members, it should provide faster response time to issues without members needing to ping a specific person who may or may not be available.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="features"></a>Features<a class="hash-link" href="#features" title="Direct link to heading">#</a></h2><ul><li>Adds/removes an &quot;on duty&quot; role of your choice<ul><li>Automatically adds back &quot;only duty&quot; role to staff who&#x27;ve manually removed the role but are designated as on duty.</li></ul></li><li>Updates channel topic in a given channel to provide a visible on duty staff list<ul><li>Respects Discord ratelimits for channel updates</li><li>Keeps user defined channel topic intact</li></ul></li><li>Automatically removes staff from the list after a time</li><li>List on-duty staff using <code>-onduty list</code></li><li>Manually remove staff from the list using <code>-offduty &lt;user&gt;</code></li><li>Force update the channel topic using <code>-onduty update</code></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="trigger"></a>Trigger<a class="hash-link" href="#trigger" title="Direct link to heading">#</a></h2><p><strong>Type:</strong> <code>Regex</code><br>
<strong>Trigger:</strong> <code>\A(-|&lt;@!?204255221017214977&gt;\s*)(o(n|ff)duty)(\s+|\z)</code></p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Unless you would like everyone to be able to use these commands, we advise that you limit it to a staff role in the role restrictions.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="usage"></a>Usage<a class="hash-link" href="#usage" title="Direct link to heading">#</a></h2><ul><li><code>-onduty</code> - Mark yourself as on duty.</li><li><code>-onduty list</code> - Display a list of staff members designated as on duty and reassign on duty role if needed.</li><li><code>-onduty update</code> - Force an update of the channel topic. Will update five minutes after the command is ran.</li><li><code>-offduty</code> - Mark yourself as off duty.</li><li><code>-offduty &lt;user&gt;</code> - Manually mark the specified user as off duty.</li></ul><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Limitations</h5></div><div class="admonition-content"><ol><li><p>On non-premium servers, the <code>onduty</code> command will occasionally require an additional command to be run.</p></li><li><p>This command was built around channel topic editing. You can use it without editing the topic but certain actions will be unnecessary or delayed.</p></li></ol></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="configuration"></a>Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">#</a></h2><ul><li><p>üìå <code>$dutyRole</code><br>
ID of your &quot;on duty&quot; role.</p></li><li><p><code>$autoOff</code><br>
Number of hours before on duty role is automatically removed.</p></li><li><p>üìå <code>$dutyChannel</code><br>
ID of the channel where the topic should be updated periodically.</p></li><li><p><code>$chanEdit</code><br>
Whether or not channel topic editing is enabled.</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="code"></a>Code<a class="hash-link" href="#code" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W gotmpl"><pre tabindex="0" class="prism-code language-gotmpl codeBlock_6upA thin-scrollbar" style="color:#b3b1ad;background-color:#191F26"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{/*</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	On-duty staff system that allows staff members to designate themselves as &quot;on-duty&quot;.</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	See &lt;https://yagpdb-cc.github.io/moderation/staff-on-duty&gt; for more information.</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	Author: dvoraknt &lt;https://github.com/dvoraknt&gt;</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">*/}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{/* Configurable values */}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{$dutyRole := 539502575758737408}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{$autoOff := 10}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{$dutyChannel := 503913846684123166}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{$chanEdit := true}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{/* End of configurable values */}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{if not (dbGet 0 &quot;modOnDuty&quot;)}}{{dbSet 0 &quot;modOnDuty&quot; &quot;&quot;}}{{end}}{{/*creates initial database slot. you can delete this after first run if you know what you are doing*/}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{$onDuty := &quot;&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{if .ExecData}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{if eq (str .ExecData) &quot;update&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{$current := 0}}{{$name := &quot;&quot;}}{{$member := &quot;&quot;}}{{$dutyList := &quot;&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{$onDuty = (dbGet 0 &quot;modOnDuty&quot;).Value}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{$dutySplit := split $onDuty &quot;;&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{if eq (len $dutySplit) 1}}{{$dutyList = &quot;None&quot;}}{{else}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{range $dutySplit}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{- $current = (toInt . ) -}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{if $current}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">				{{$member = getMember $current}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">				{{$name = or $member.Nick $member.User.Username}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">				{{- $dutyList = joinStr &quot;, &quot; $dutyList $name -}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">				{{if not (targetHasRoleID $current $dutyRole)}}{{giveRoleID $current $dutyRole}}{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{end}}{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{if $chanEdit}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{$curTopic := index (reSplit `(-\s)?Staff on duty:` (getChannel $dutyChannel).Topic) 0}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{if $curTopic}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">				{{$curTopic = print $curTopic &quot; - Staff on duty: &quot; $dutyList}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{else}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">				{{$curTopic = print &quot;Staff on duty: &quot; $dutyList}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{if gt (len $curTopic) 1024}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">				{{sendDM (print &quot;**On duty CC report:** your channel topic could not be changed - topic exceeded 1024 characters. Please shorten your user defined topic text or contact the person in charge of your servers YAGPDB custom commands to disable the staff list.&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{else}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">				{{editChannelTopic $dutyChannel (print $curTopic)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{else}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{takeRoleID .ExecData $dutyRole 0}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{sendDM (print &quot;You have been automatically removed from duty after (&quot; $autoOff &quot;) hour(s), if this is a mistake go back on duty.&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{$onDuty = (dbGet 0 &quot;modOnDuty&quot;).Value}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{$onDuty = reReplace (print .ExecData &quot;;&quot;) $onDuty &quot;&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{dbSet 0 &quot;modOnDuty&quot; $onDuty}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{if not (dbGet 0 &quot;onDutyCD&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{execCC .CCID nil 305 &quot;update&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{dbSetExpire 0 &quot;onDutyCD&quot; &quot;on CD&quot; 306}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{else}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{/*==================*/}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{if and .CmdArgs (eq .Cmd &quot;-offduty&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{if $idiotStaff := reFind `(\d{17,20})` (index .CmdArgs 0)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{takeRoleID $idiotStaff $dutyRole 0}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{sendMessage  nil (print (getMember $idiotStaff).User.String &quot; is no longer on duty.&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{$onDuty = (dbGet 0 &quot;modOnDuty&quot;).Value}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{$onDuty = reReplace (print $idiotStaff &quot;;&quot;) $onDuty &quot;&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{dbSet 0 &quot;modOnDuty&quot; $onDuty}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{if not (dbGet 0 &quot;onDutyCD&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{execCC .CCID nil 305 &quot;update&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{dbSetExpire 0 &quot;onDutyCD&quot; &quot;on CD&quot; 306}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{else}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{sendMessage nil (print &quot;No valid mention or user ID found.&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{else if and .CmdArgs (eq .Cmd &quot;-onduty&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{$subCmd := index .CmdArgs 0}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{if eq $subCmd &quot;list&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{$current := 0}}{{$name := &quot;&quot;}}{{$member := &quot;&quot;}}{{$dutyList := &quot;&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{$onDuty = (dbGet 0 &quot;modOnDuty&quot;).Value}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{$dutySplit := split $onDuty &quot;;&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{if eq (len $dutySplit) 1}}{{$dutyList = &quot;None&quot;}}{{else}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{range $dutySplit}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{- $current = (toInt . ) -}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{if $current}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">				{{$member = getMember $current}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">				{{$name = or $member.Nick $member.User.Username}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">				{{- $dutyList = joinStr &quot;, &quot; $dutyList $name -}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">				{{if not (targetHasRoleID $current $dutyRole)}}{{giveRoleID $current $dutyRole}}{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{end}}{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{sendMessage nil (print &quot;Staff on duty: &quot; $dutyList)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{else if eq $subCmd &quot;update&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{if and $chanEdit (not (dbGet 0 &quot;onDutyCD&quot;))}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{execCC .CCID nil 305 &quot;update&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{dbSetExpire 0 &quot;onDutyCD&quot; &quot;on CD&quot; 306}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{sendMessage nil (print &quot;Thanks! I&#x27;ll update the channel topic in five minutes.&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{else if $chanEdit}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{sendMessage nil (print &quot;Looks like I don&#x27;t need that right now.&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{else}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">			{{sendMessage nil (print &quot;Your server has topic edits disabled so this command is pretty much useless. If you want me to double check that all on duty staff members still have the role you can send `-onduty list`&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{else}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{sendMessage nil (print &quot;You can&#x27;t force other people on duty!&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{else}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{/*==================*/}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{if and (hasRoleID $dutyRole) (eq .Cmd &quot;-onduty&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{sendMessage nil (print &quot;You&#x27;re already on duty! Send `-offduty` to take a break.&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{else if and (not (hasRoleID $dutyRole)) (eq .Cmd &quot;-offduty&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{sendMessage nil (print &quot;You&#x27;re already off duty! Send `-onduty` to go on patrol.&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{else if and (hasRoleID $dutyRole) (eq .Cmd &quot;-offduty&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{removeRoleID $dutyRole 0}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{sendMessage  nil (print &quot;You are now off duty.&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{$onDuty = (dbGet 0 &quot;modOnDuty&quot;).Value}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{$onDuty = reReplace (print .User.ID &quot;;&quot;) $onDuty &quot;&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{dbSet 0 &quot;modOnDuty&quot; $onDuty}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{cancelScheduledUniqueCC .CCID (print &quot;onduty-&quot; .User.ID)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{if not (dbGet 0 &quot;onDutyCD&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{execCC .CCID nil 305 &quot;update&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{dbSetExpire 0 &quot;onDutyCD&quot; &quot;on CD&quot; 306}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{else if and (not (hasRoleID $dutyRole)) (eq .Cmd &quot;-onduty&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{addRoleID $dutyRole}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{sendMessage nil (print &quot;You are now on duty.&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{$onDuty = print (or (dbGet 0 &quot;modOnDuty&quot;).Value) .User.ID &quot;;&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{dbSet 0 &quot;modOnDuty&quot; $onDuty}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{scheduleUniqueCC .CCID nil (mult 3600 $autoOff) (print &quot;onduty-&quot; .User.ID) .User.ID}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{if and $chanEdit (not (dbGet 0 &quot;onDutyCD&quot;)) (not .IsPremium)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{sendMessage nil (print .User.Mention &quot; Woah there, unfortunately since this server doesn&#x27;t have YAGPDB premium you&#x27;re going to have to send `-onduty update` to initiate the channel topic update. Sorry for the extra work but I could only make this work for standard servers using this method. You&#x27;ll only have to do this step under certain conditions so hopefully not too often.&quot;)}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{else if and $chanEdit (not (dbGet 0 &quot;onDutyCD&quot;))}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{execCC .CCID nil 305 &quot;update&quot;}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">		{{dbSetExpire 0 &quot;onDutyCD&quot; &quot;on CD&quot; 306}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">	{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{end}}</span></span><span class="token-line" style="color:#b3b1ad"><span class="token plain">{{end}}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="author"></a>Author<a class="hash-link" href="#author" title="Direct link to heading">#</a></h2><p>This custom command was written by <a href="https://github.com/dvoraknt" target="_blank" rel="noopener noreferrer">@dvoraknt</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/yagpdb-cc/yagpdb-cc/edit/master/website/docs/moderation/staff-on-duty.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/moderation/slowmode"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Slowmode</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/suggestion/overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#features" class="table-of-contents__link">Features</a></li><li><a href="#trigger" class="table-of-contents__link">Trigger</a></li><li><a href="#usage" class="table-of-contents__link">Usage</a></li><li><a href="#configuration" class="table-of-contents__link">Configuration</a></li><li><a href="#code" class="table-of-contents__link">Code</a></li><li><a href="#author" class="table-of-contents__link">Author</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">YAGPDB CCs</a></li><li class="footer__item"><a href="https://docs.yagpdb.xyz" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Documentation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://learn.yagpdb.xyz" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Learning Center<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/jonas747/yagpdb" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>YAGPDB Source<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.com/invite/4udtcA5" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>YAGPDB Community Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/yagpdb-cc/yagpdb-cc" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>YAGPDB CC GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://reddit.com/r/YAGPDB" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>YAGPDB Subreddit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 YAGPDB-CC contributors under the MIT license.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.faac80f8.js"></script>
<script src="/assets/js/main.0bbf4581.js"></script>
</body>
</html>